/* Copyright (c) 2012 HyeonJe Jun (http://github.com/noraesae)
 * Licensed under the MIT License
 */"use strict";(function(e){typeof define=="function"&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){var t={wheelSpeed:10,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0},n=function(){var e=0;return function(){var t=e;e+=1;return".perfect-scrollbar-"+t}}();e.fn.perfectScrollbar=function(r,i){return this.each(function(){var s=e.extend(!0,{},t),o=e(this);typeof r=="object"?e.extend(!0,s,r):i=r;if(i==="update"){o.data("perfect-scrollbar-update")&&o.data("perfect-scrollbar-update")();return o}if(i==="destroy"){o.data("perfect-scrollbar-destroy")&&o.data("perfect-scrollbar-destroy")();return o}if(o.data("perfect-scrollbar"))return o.data("perfect-scrollbar");o.addClass("ps-container");var u=e("<div class='ps-scrollbar-x-rail'></div>").appendTo(o),a=e("<div class='ps-scrollbar-y-rail'></div>").appendTo(o),f=e("<div class='ps-scrollbar-x'></div>").appendTo(u),l=e("<div class='ps-scrollbar-y'></div>").appendTo(a),c,h,p,d,v,m,g,y,b=parseInt(u.css("bottom"),10),w,E,S=parseInt(a.css("right"),10),x=n(),T=function(e,t){var n=e+t,r=d-w;n<0?E=0:n>r?E=r:E=n;var i=parseInt(E*(m-d)/(d-w),10);o.scrollTop(i);u.css({bottom:b-i})},N=function(e,t){var n=e+t,r=p-g;n<0?y=0:n>r?y=r:y=n;var i=parseInt(y*(v-p)/(p-g),10);o.scrollLeft(i);a.css({right:S-i})},C=function(e){s.minScrollbarLength&&(e=Math.max(e,s.minScrollbarLength));return e},k=function(){u.css({left:o.scrollLeft(),bottom:b-o.scrollTop(),width:p,display:c?"inherit":"none"});a.css({top:o.scrollTop(),right:S-o.scrollLeft(),height:d,display:h?"inherit":"none"});f.css({left:y,width:g});l.css({top:E,height:w})},L=function(){p=o.width();d=o.height();v=o.prop("scrollWidth");m=o.prop("scrollHeight");if(!s.suppressScrollX&&p+s.scrollXMarginOffset<v){c=!0;g=C(parseInt(p*p/v,10));y=parseInt(o.scrollLeft()*(p-g)/(v-p),10)}else{c=!1;g=0;y=0;o.scrollLeft(0)}if(!s.suppressScrollY&&d+s.scrollYMarginOffset<m){h=!0;w=C(parseInt(d*d/m,10));E=parseInt(o.scrollTop()*(d-w)/(m-d),10)}else{h=!1;w=0;E=0;o.scrollTop(0)}E>=d-w&&(E=d-w);y>=p-g&&(y=p-g);k()},A=function(){var t,n;f.bind("mousedown"+x,function(e){n=e.pageX;t=f.position().left;u.addClass("in-scrolling");e.stopPropagation();e.preventDefault()});e(document).bind("mousemove"+x,function(e){if(u.hasClass("in-scrolling")){N(t,e.pageX-n);e.stopPropagation();e.preventDefault()}});e(document).bind("mouseup"+x,function(e){u.hasClass("in-scrolling")&&u.removeClass("in-scrolling")});t=n=null},O=function(){var t,n;l.bind("mousedown"+x,function(e){n=e.pageY;t=l.position().top;a.addClass("in-scrolling");e.stopPropagation();e.preventDefault()});e(document).bind("mousemove"+x,function(e){if(a.hasClass("in-scrolling")){T(t,e.pageY-n);e.stopPropagation();e.preventDefault()}});e(document).bind("mouseup"+x,function(e){a.hasClass("in-scrolling")&&a.removeClass("in-scrolling")});t=n=null},M=function(e,t){var n=o.scrollTop();if(e===0){if(!h)return!1;if(n===0&&t>0||n>=m-d&&t<0)return!s.wheelPropagation}var r=o.scrollLeft();if(t===0){if(!c)return!1;if(r===0&&e<0||r>=v-p&&e>0)return!s.wheelPropagation}return!0},_=function(){var e=!1;o.bind("mousewheel"+x,function(t,n,r,i){if(!s.useBothWheelAxes){o.scrollTop(o.scrollTop()-i*s.wheelSpeed);o.scrollLeft(o.scrollLeft()+r*s.wheelSpeed)}else h&&!c?i?o.scrollTop(o.scrollTop()-i*s.wheelSpeed):o.scrollTop(o.scrollTop()+r*s.wheelSpeed):c&&!h&&(r?o.scrollLeft(o.scrollLeft()+r*s.wheelSpeed):o.scrollLeft(o.scrollLeft()-i*s.wheelSpeed));L();e=M(r,i);e&&t.preventDefault()});o.bind("MozMousePixelScroll"+x,function(t){e&&t.preventDefault()})},D=function(){var t=!1;o.bind("mouseenter"+x,function(e){t=!0});o.bind("mouseleave"+x,function(e){t=!1});var n=!1;e(document).bind("keydown"+x,function(e){if(!t)return;var r=0,i=0;switch(e.which){case 37:r=-3;break;case 38:i=3;break;case 39:r=3;break;case 40:i=-3;break;case 33:i=9;break;case 32:case 34:i=-9;break;case 35:i=-d;break;case 36:i=d;break;default:return}o.scrollTop(o.scrollTop()-i*s.wheelSpeed);o.scrollLeft(o.scrollLeft()+r*s.wheelSpeed);n=M(r,i);n&&e.preventDefault()})},P=function(){var e=function(e){e.stopPropagation()};l.bind("click"+x,e);a.bind("click"+x,function(e){var t=parseInt(w/2,10),n=e.pageY-a.offset().top-t,r=d-w,i=n/r;i<0?i=0:i>1&&(i=1);o.scrollTop((m-d)*i)});f.bind("click"+x,e);u.bind("click"+x,function(e){var t=parseInt(g/2,10),n=e.pageX-u.offset().left-t,r=p-g,i=n/r;i<0?i=0:i>1&&(i=1);o.scrollLeft((v-p)*i)})},H=function(){var t=function(e,t){o.scrollTop(o.scrollTop()-t);o.scrollLeft(o.scrollLeft()-e);L()},n={},r=0,i={},s=null,u=!1;e(window).bind("touchstart"+x,function(e){u=!0});e(window).bind("touchend"+x,function(e){u=!1});o.bind("touchstart"+x,function(e){var t=e.originalEvent.targetTouches[0];n.pageX=t.pageX;n.pageY=t.pageY;r=(new Date).getTime();s!==null&&clearInterval(s);e.stopPropagation()});o.bind("touchmove"+x,function(e){if(!u&&e.originalEvent.targetTouches.length===1){var s=e.originalEvent.targetTouches[0],o={};o.pageX=s.pageX;o.pageY=s.pageY;var a=o.pageX-n.pageX,f=o.pageY-n.pageY;t(a,f);n=o;var l=(new Date).getTime();i.x=a/(l-r);i.y=f/(l-r);r=l;e.preventDefault()}});o.bind("touchend"+x,function(e){clearInterval(s);s=setInterval(function(){if(Math.abs(i.x)<.01&&Math.abs(i.y)<.01){clearInterval(s);return}t(i.x*30,i.y*30);i.x*=.8;i.y*=.8},10)})},B=function(){o.bind("scroll"+x,function(e){L()})},j=function(){o.unbind(x);e(window).unbind(x);e(document).unbind(x);o.data("perfect-scrollbar",null);o.data("perfect-scrollbar-update",null);o.data("perfect-scrollbar-destroy",null);f.remove();l.remove();u.remove();a.remove();f=l=p=d=v=m=g=y=b=w=E=S=null},F=function(t){o.addClass("ie").addClass("ie"+t);var n=function(){var t=function(){e(this).addClass("hover")},n=function(){e(this).removeClass("hover")};o.bind("mouseenter"+x,t).bind("mouseleave"+x,n);u.bind("mouseenter"+x,t).bind("mouseleave"+x,n);a.bind("mouseenter"+x,t).bind("mouseleave"+x,n);f.bind("mouseenter"+x,t).bind("mouseleave"+x,n);l.bind("mouseenter"+x,t).bind("mouseleave"+x,n)},r=function(){k=function(){f.css({left:y+o.scrollLeft(),bottom:b,width:g});l.css({top:E+o.scrollTop(),right:S,height:w});f.hide().show();l.hide().show()}};if(t===6){n();r()}},I="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,q=function(){var e=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/);e&&e[1]==="msie"&&F(parseInt(e[2],10));L();B();A();O();P();I&&H();o.mousewheel&&_();s.useKeyboard&&D();o.data("perfect-scrollbar",o);o.data("perfect-scrollbar-update",L);o.data("perfect-scrollbar-destroy",j)};q();return o})}});